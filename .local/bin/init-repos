#!/usr/bin/env pwsh

New-Item ~/src -ItemType Directory -Force | Out-Null

function CloneRepos([string]$folder, [Object[]]$repos) {
    $path = Join-Path ~/src $folder
    if (-Not (Test-Path $path)) {
        New-Item $path -ItemType Directory -Force | Out-Null
    }
    $repos | ForEach-Object {
        $path = Join-Path ~/src $folder $_.name
        if (-Not (Test-Path $path)) {
            Write-Host "Cloning $($_.name)"
            git clone "$($_.url).git" $path
        }
    }    
}


$repos = @(
    @{
        name = "dotfiles"
        url  = "https://github.com/RobCannon/dotfiles"
    }
)
CloneRepos "RobCannon" $repos

$repos = @(
    @{
        name = "idp-scim-sync"
        url  = "https://github.com/slashdevops/idp-scim-sync"
    }
)
CloneRepos "GitHub" $repos


$repos = gh repo list AccelerateLearning --json "name,url" | ConvertFrom-json
CloneRepos "AccelerateLearning" $repos
